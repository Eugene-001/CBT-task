<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CBT Task</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
  </head>
  <body>
    <!-- School Details Section -->
    <div class="school-section">
      <div class="schoolname">School of Hard Knocks</div>
      <div class="intro">
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Earum saepe,
        voluptatem soluta eaque assumenda sed expedita ad corrupti repellendus
        sequi! Lorem ipsum dolor sit amet, consectetur adipisicing elit. Earum
        saepe, voluptatem soluta eaque assumenda sed expedita ad corrupti
        repellendus sequi!
      </div>

      <div class="student-info-section">
        <div class="Student-form">
          <form>
            <label for="Department">Department</label>
            <select name="Department" id="Department">
              <option value="">Select Department</option>
              <option value="Maths">Maths</option>
              <option value="Science">Science</option>
              <option value="History">History</option>
            </select>

            <label for="Course-code">Course code</label>
            <input
              type="text"
              id="Course-code"
              name="Course-code"
              class="Course-code-field"
              placeholder="Enter course code"
            />

            <label for="Reg-No">Registration Number</label>
            <input
              type="text"
              id="Reg-No"
              name="Reg-No"
              class="Reg-No-field"
              placeholder="Enter registration number"
            />

            <label for="Full-Name">Full Name</label>
            <input
              type="text"
              id="Full-Name"
              name="Full-Name"
              class="Full-Name-field"
              placeholder="Enter full name"
            />

            <label for="Email">Email</label>
            <input
              type="email"
              id="Email"
              name="Email"
              class="Email-field"
              placeholder="Enter email"
            />
          </form>
        </div>
      </div>
    </div>

    <!-- Student Information Section -->

    <!-- Quiz Questions Section -->
    <div class="quiz-section">
      <div class="questions">
        <form>
          <fieldset>
            <legend>
              Which of the following best describes compound interest?
            </legend>

            <div>
              <input type="radio" id="answer-a" name="Question-1" value="A" />
              <label for="answer-a"
                >Interest calculated only on the principal</label
              >
            </div>

            <div>
              <input type="radio" id="answer-b" name="Question-1" value="B" />
              <label for="answer-b"
                >Interest calculated on principal and previous interest</label
              >
            </div>

            <div>
              <input type="radio" id="answer-c" name="Question-1" value="C" />
              <label for="answer-c">A fee charged by banks</label>
            </div>

            <div>
              <input type="radio" id="answer-d" name="Question-1" value="D" />
              <label for="answer-d">Interest that decreases over time</label>
            </div>
          </fieldset>

          <!-- Number 2 -->
          <fieldset>
            <legend>What does a credit score represent?</legend>

            <div>
              <input type="radio" id="answer-a" name="Question-2" value="A" />
              <label for="answer-a">Your total income</label>
            </div>

            <div>
              <input type="radio" id="answer-b" name="Question-2" value="B" />
              <label for="answer-b">Your financial goals</label>
            </div>

            <div>
              <input type="radio" id="answer-c" name="Question-2" value="C" />
              <label for="answer-c">Your creditworthiness</label>
            </div>

            <div>
              <input type="radio" id="answer-d" name="Question-2" value="D" />
              <label for="answer-d">Your net worth</label>
            </div>
          </fieldset>

          <!-- Number 3 -->
          <fieldset>
            <legend>
              Which of these are examples of fixed monthly expenses? (Select all
              that apply)
            </legend>

            <div>
              <input
                type="checkbox"
                id="answer-a"
                name="Question-3"
                value="A"
              />
              <label for="answer-a">Rent</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-b"
                name="Question-3"
                value="B"
              />
              <label for="answer-b">Netflix subscription</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-c"
                name="Question-3"
                value="C"
              />
              <label for="answer-c">Eating out</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-d"
                name="Question-3"
                value="D"
              />
              <label for="answer-d">Electricity bill</label>
            </div>
          </fieldset>

          <!-- Number 4 -->
          <fieldset>
            <legend>
              Which of the following are considered bad financial habits?
              (Select all that apply)
            </legend>

            <div>
              <input
                type="checkbox"
                id="answer-a"
                name="Question-4"
                value="A"
              />
              <label for="answer-a">Budgeting monthly</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-b"
                name="Question-4"
                value="B"
              />
              <label for="answer-b">Spending to impress others</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-c"
                name="Question-4"
                value="C"
              />
              <label for="answer-c">Saving regularly</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-d"
                name="Question-4"
                value="D"
              />
              <label for="answer-d">Borrowing with no repayment plan</label>
            </div>
          </fieldset>

          <!-- Number 5 -->
          <fieldset>
            <legend>
              In your own words, explain why it's important to have an emergency
              fund.
            </legend>

            <div>
              <input
                type="textarea"
                id="answer-a"
                name="Question-5"
                placeholder="In your own words, explain why it's important to have an emergency fund."
                class="textarea"
              />
              <label for="answer-a"></label>
            </div>
          </fieldset>

          <!-- Number 6 -->
          <fieldset>
            <legend>
              What is the recommended percentage of your income to save monthly?
            </legend>

            <div>
              <input type="radio" id="answer-a" name="Question-6" value="A" />
              <label for="answer-a">5%</label>
            </div>

            <div>
              <input type="radio" id="answer-b" name="Question-6" value="B" />
              <label for="answer-b">10%</label>
            </div>

            <div>
              <input type="radio" id="answer-c" name="Question-6" value="C" />
              <label for="answer-c">20%</label>
            </div>

            <div>
              <input type="radio" id="answer-d" name="Question-6" value="D" />
              <label for="answer-d">50%</label>
            </div>
          </fieldset>

          <!-- Number 7 -->
          <fieldset>
            <legend>
              Which of these can be considered assets? (Select all that apply)
            </legend>

            <div>
              <input
                type="checkbox"
                id="answer-a"
                name="Question-7"
                value="A"
              />
              <label for="answer-a">A car used for Uber</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-b"
                name="Question-7"
                value="B"
              />
              <label for="answer-b">A house you rent out</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-c"
                name="Question-7"
                value="C"
              />
              <label for="answer-c">A new designer shoe</label>
            </div>

            <div>
              <input
                type="checkbox"
                id="answer-d"
                name="Question-7"
                value="D"
              />
              <label for="answer-d">Your savings account</label>
            </div>
          </fieldset>

          <!-- Number 8 -->
          <fieldset>
            <legend>
              Write a short explanation of the difference between saving and
              investing.
            </legend>

            <div>
              <input
                type="textarea"
                id="answer-a"
                name="Question-8"
                placeholder="Write your answer here..."
                class="textarea"
              />
            </div>
          </fieldset>

          <!-- Number 9 -->
          <fieldset>
            <legend>
              Write a short explanation of the difference between saving and
              investing.
            </legend>

            <div>
              <input
                type="textarea"
                id="answer-a"
                name="Question-9"
                placeholder="Write your answer here..."
                class="textarea"
              />
            </div>
          </fieldset>

          <!-- Number 10 -->
          <fieldset>
            <legend>
              Write a short explanation of the difference between saving and
              investing.
            </legend>

            <div>
              <input
                type="textarea"
                id="answer-a"
                name="Question-10"
                placeholder="Write your answer here..."
                class="textarea"
              />
            </div>
          </fieldset>

          <button type="submit">Submit Quiz</button>
        </form>
      </div>
    </div>
    <!-- 
    THIS IS WHERE THE JAVASCRIPT CODES STARTS FROM. -->

    <script>
      const answerKey = {
        "Question-1": "B",
        "Question-2": "C",
        "Question-3": ["A", "B", "D"],
        "Question-4": ["B", "D"],
        "Question-6": "C",
        "Question-7": ["A", "B", "D"],
      };

      document
        .querySelector(".quiz-section form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = new FormData(this);
          const userAnswers = extractAnswers(formData);
          const grade = CalculateGrade(userAnswers);

          // Come back to this then work on the modal afterwards.
          alert(
            "Your Score: " +
              grade.score +
              "/" +
              grade.total +
              " (" +
              grade.percentage +
              "%)"
          );
        });

      function arraysEqual(arr1, arr2) {
        return (
          arr1.length === arr2.length &&
          arr1.every((val, index) => val === arr2[index])
        );
      }

      function extractAnswers(formData) {
        const answers = {};
        for (let [name, value] of formData.entries()) {
          if (name.startsWith("Question-")) {
            if (!answers[name]) {
              answers[name] = [];
            }
            answers[name].push(value);
          }
        }
        return answers;
      }

      function CalculateGrade(userAnswers) {
        let totalQuestions = Object.keys(answerKey).length;
        let correctAnswers = 0;
        let questionResults = {};

        for (let questionName in answerKey) {
          const correctAnswer = answerKey[questionName];
          const userAnswer = userAnswers[questionName] || [];

          let isCorrect = false;

          if (Array.isArray(correctAnswer)) {
            isCorrect = arraysEqual(userAnswer.sort(), correctAnswer.sort());
          } else {
            isCorrect = userAnswer.includes(correctAnswer);
          }

          if (isCorrect) {
            correctAnswers++;
          }

          questionResults[questionName] = {
            correct: isCorrect,
            userAnswer: userAnswer,
            correctAnswer: correctAnswer,
          };
        }

        return {
          score: correctAnswers,
          total: totalQuestions,
          percentage: Math.round((correctAnswers / totalQuestions) * 100),
          results: questionResults,
        };
      }
    </script>
  </body>
</html>
